<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Boosted multivariate trees for longitudinal data — boostmtree • boostmtree</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Boosted multivariate trees for longitudinal data — boostmtree"><meta name="description" content="Multivariate extension of Friedman's gradient descent boosting method
  for modeling continuous or binary longitudinal response using
  multivariate tree base learners (Pande et
  al., 2017).  Covariate-time interactions are modeled using penalized
  B-splines (P-splines) with estimated adaptive smoothing parameter."><meta property="og:description" content="Multivariate extension of Friedman's gradient descent boosting method
  for modeling continuous or binary longitudinal response using
  multivariate tree base learners (Pande et
  al., 2017).  Covariate-time interactions are modeled using penalized
  B-splines (P-splines) with estimated adaptive smoothing parameter."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">boostmtree</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Boosted multivariate trees for longitudinal data</h1>

      <div class="d-none name"><code>boostmtree.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Multivariate extension of Friedman's gradient descent boosting method
  for modeling continuous or binary longitudinal response using
  multivariate tree base learners (Pande et
  al., 2017).  Covariate-time interactions are modeled using penalized
  B-splines (P-splines) with estimated adaptive smoothing parameter.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">boostmtree</span><span class="op">(</span><span class="va">x</span>,</span>
<span>            <span class="va">tm</span>,</span>
<span>            <span class="va">id</span>,</span>
<span>            <span class="va">y</span>,</span>
<span>            family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Continuous"</span>,<span class="st">"Binary"</span>,<span class="st">"Nominal"</span>,<span class="st">"Ordinal"</span><span class="op">)</span>,</span>
<span>            y_reference <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>            M <span class="op">=</span> <span class="fl">200</span>,</span>
<span>            nu <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>            na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na.omit"</span>,<span class="st">"na.impute"</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>            K <span class="op">=</span> <span class="fl">5</span>,</span>
<span>            mtry <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>            nknots <span class="op">=</span> <span class="fl">10</span>,</span>
<span>            d <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            pen.ord <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            <span class="va">lambda</span>,</span>
<span>            <span class="va">rho</span>,</span>
<span>            lambda.max <span class="op">=</span> <span class="fl">1e6</span>,</span>
<span>            lambda.iter <span class="op">=</span> <span class="fl">2</span>,</span>
<span>            svd.tol <span class="op">=</span> <span class="fl">1e-6</span>,</span>
<span>            forest.tol <span class="op">=</span> <span class="fl">1e-3</span>,</span>
<span>            verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            cv.flag <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>            eps <span class="op">=</span> <span class="fl">1e-5</span>,</span>
<span>            mod.grad <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>            NR.iter <span class="op">=</span> <span class="fl">3</span>,</span>
<span>            <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Data frame (or matrix) containing the x-values.   Rows
      must be duplicated to match the number of time points for an individual.
      That is, if individual <em>i</em> has <em>n[i]</em> outcome y-values,
      then there must be <em>n[i]</em> duplicate rows of <em>i</em>'s x-value.</p></dd>

    <dt id="arg-tm">tm<a class="anchor" aria-label="anchor" href="#arg-tm"></a></dt>
<dd><p>Vector of time values, one entry for each row in <code>x</code>.</p></dd>

    <dt id="arg-id">id<a class="anchor" aria-label="anchor" href="#arg-id"></a></dt>
<dd><p>Unique subject identifier, one entry for each row in <code>x</code>.</p></dd>

    <dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Observed y-value, one entry for each row in <code>x</code>.</p></dd>

    <dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Family of the response variable <code>y</code>. Use any one
    from {"Continuous", "Binary","Nominal","Ordinal"} based on the scale of <code>y</code>.</p></dd>

    <dt id="arg-y-reference">y_reference<a class="anchor" aria-label="anchor" href="#arg-y-reference"></a></dt>
<dd><p>Set this value, among the unique <code>y</code> values
    when <code>family</code> == "Nominal". If NULL, lowest value, among unique <code>y</code> values, is used.</p></dd>

    <dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>Number of boosting iterations</p></dd>

    <dt id="arg-nu">nu<a class="anchor" aria-label="anchor" href="#arg-nu"></a></dt>
<dd><p>Boosting regularization parameter.  A value in (0,1].</p></dd>

    <dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>Remove missing values (casewise) or impute it. Default is to impute the missign values.</p></dd>

    <dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Number of terminal nodes used for the multivariate tree learner.</p></dd>

    <dt id="arg-mtry">mtry<a class="anchor" aria-label="anchor" href="#arg-mtry"></a></dt>
<dd><p>Number of <code>x</code> variables selected randomly for tree fitting. Default is use all <code>x</code> variables.</p></dd>

    <dt id="arg-nknots">nknots<a class="anchor" aria-label="anchor" href="#arg-nknots"></a></dt>
<dd><p>Number of knots used for the B-spline for modeling the
    time interaction effect.</p></dd>

    <dt id="arg-d">d<a class="anchor" aria-label="anchor" href="#arg-d"></a></dt>
<dd><p>Degree of the piecewise B-spline polynomial (no time
      effect is fit when d &lt; 1).</p></dd>

    <dt id="arg-pen-ord">pen.ord<a class="anchor" aria-label="anchor" href="#arg-pen-ord"></a></dt>
<dd><p>Differencing order used to define the penalty with
      increasing values implying greater smoothness.</p></dd>

    <dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Smoothing (penalty) parameter used for B-splines with
      increasing values associated with increasing
      smoothness/penalization. If missing, or non-positive, the value is
      estimated adaptively using a mixed models approach.</p></dd>

    <dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>If missing, rho is estimated, else, use the <code>rho</code> value specified in this argument.</p></dd>

    <dt id="arg-lambda-max">lambda.max<a class="anchor" aria-label="anchor" href="#arg-lambda-max"></a></dt>
<dd><p>Tolerance used for adaptively estimated lambda
      (caps it).  For experts only.</p></dd>

    <dt id="arg-lambda-iter">lambda.iter<a class="anchor" aria-label="anchor" href="#arg-lambda-iter"></a></dt>
<dd><p>Number of iterations used to estimate lambda
      (only applies when lambda is not supplied and adaptive smoothing
      is employed).</p></dd>

    <dt id="arg-svd-tol">svd.tol<a class="anchor" aria-label="anchor" href="#arg-svd-tol"></a></dt>
<dd><p>Tolerance value used in the SVD calculation of the
      penalty matrix.  For experts only.</p></dd>

    <dt id="arg-forest-tol">forest.tol<a class="anchor" aria-label="anchor" href="#arg-forest-tol"></a></dt>
<dd><p>Tolerance used for forest weighted least squares
      solution.  Experimental and for experts only.</p></dd>

    <dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Should verbose output be printed?</p></dd>

    <dt id="arg-cv-flag">cv.flag<a class="anchor" aria-label="anchor" href="#arg-cv-flag"></a></dt>
<dd><p>Should in-sample cross-validation (CV) be used to determine
      optimal stopping using out of bag data?</p></dd>

     <dt id="arg-eps">eps<a class="anchor" aria-label="anchor" href="#arg-eps"></a></dt>
<dd><p>Tolerance value used for determining the optimal
       <code>M</code>. Applies only if <code class="command">cv.flag</code> = TRUE.  For experts only.</p></dd>

    <dt id="arg-mod-grad">mod.grad<a class="anchor" aria-label="anchor" href="#arg-mod-grad"></a></dt>
<dd><p>Use a modified gradient? See details below.</p></dd>

    <dt id="arg-nr-iter">NR.iter<a class="anchor" aria-label="anchor" href="#arg-nr-iter"></a></dt>
<dd><p>Number of Newton-Raphson iteration. Applied
    for <code class="command">family</code> = {Binary","Nominal","Ordinal"}.</p></dd>

    <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>


<p>Each individual has observed y-values, over possibly different time
  points, with possibly differing number of time points.  Given y, the
  time points, and x, the conditional mean time profile of y is
  estimated using gradient boosting in which the gradient is derived
  from a criterion function involving a working variance matrix for y
  specified as an equicorrelation matrix with parameter <em>rho</em>
  multiplied by a variance parameter <em>phi</em>. Multivariate trees are
  used for base learners and weighted least squares is used for solving
  the terminal node optimization problem.  This provides solutions to
  the core parameters of the algorithm.  For ancillary parameters, a
  mixed-model formulation is used to estimate the smoothing parameter
  associated with the B-splines used for the time-interaction effect,
  although the user can manually set the smoothing parameter as well.
  Ancillary parameters <em>rho</em> and <em>phi</em> are estimated using GLS
  (generalized least squares).</p>
<p>In the original boostmtree algorithm (Pande et al., 2017), the
  equicorrelation parameter <em>rho</em> is used in two places in the
  algorithm: (1) for growing trees using the gradient, which depends
  upon <em>rho</em>; and (2) for solving the terminal node optimization
  problem which also uses the gradient.  However, Pande (2017) observed
  that setting <em>rho</em> to zero in the gradient used for growing trees
  improved performance of the algorithm, especially in high dimensions.
  For this reason the default setting used in this algorithm is to set
  <em>rho</em> to zero in the gradient for (1).  The <code>rho</code> in the
  gradient for (2) is not touched.  The option <code>mod.grad</code> specifies
  whether a modified gradient is used in the tree growing process and is
  TRUE by default.</p>
<p>By default, trees are grown from a bootstrap sample of the data –
  thus the boosting method employed here is a modified example of
  stochastic gradient descent boosting (Friedman, 2002).  Stochastic
  descent often improves performance and has the added advantage that
  out-of-sample data (out-of-bag, OOB) can be used to calculate
  variable importance (VIMP).</p>
<p>The package implements R-side parallel processing by replacing
  the R function <code class="command">lapply</code> with <code class="command">mclapply</code> found in the
  <span class="pkg">parallel</span> package.  You can set the number of cores accessed by
  <code class="command">mclapply</code> by issuing the command <code class="command">options(mc.cores =
    x)</code>, where <code class="command">x</code> is the number of cores.  The options command
  can also be placed in the users .Rprofile file for convenience.  You
  can, alternatively, initialize the environment variable
  <code class="command">MC_CORES</code> in your shell environment.</p>
<p>As an example, issuing the following options command uses all
  available cores for R-side parallel processing:</p>
<p><code class="command">options(mc.cores=detectCores())</code></p>
<p>However, be cautious when setting <code class="command">mc.cores</code>.  This can create
  not only high CPU usage but also high RAM usage, especially when using
  functions <code class="command">partialPlot</code> and <code class="command">predict</code>.</p>
<p>The method can impute the missing observations in x (covariates) using
  on the fly imputation. Details regarding can be found in the
  <span class="pkg">randomForestSRC</span> package. If missing values are present in the
  <code>tm</code>, <code>id</code> or <code>y</code>, the user should either impute or
  delete these values before executing the function.</p>
<p>Finally note <code>cv.flag</code> can be used for an in-sample
  cross-validated estimate of prediction error.  This is used to
  determine the optimized number of boosting iterations <em>Mopt</em>.
  The final mu predictor is evaluated at this value and is
  cross-validated.  The prediction error returned via <code class="command">err.rate</code>
  is standardized by the overall standard deviation of y.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An
  object of class <code>(boostmtree, grow)</code> with the following
  components:</p>
<p></p>
<dl><dt>x</dt>
<dd><p>The x-values, but with only one row per individual
       (i.e. duplicated rows are removed). Values sorted on <code>id</code>.</p></dd>

     <dt>xvar.names</dt>
<dd><p>X-variable names.</p></dd>

     <dt>time</dt>
<dd><p>List with each component containing the time
       points for a given individual. Values sorted on <code>id</code>.</p></dd>

     <dt>id</dt>
<dd><p>Sorted subject identifier.</p></dd>

     <dt>y</dt>
<dd><p>List with each component containing the observed
       y-values for a given individual. Values sorted on <code>id</code>.</p></dd>

     <dt>Yorg</dt>
<dd><p>For family == "Nominal" or family == "Ordinal", this provides the
     response in list-format where each element coverted the response into the binary response.</p></dd>

     <dt>family</dt>
<dd><p>Family of <code>y</code>.</p></dd>

     <dt>ymean</dt>
<dd><p>Overall mean of y-values for all individuals. If <code>family</code> =
     "Binary", <code>ymean</code> = 0.</p></dd>

     <dt>ysd</dt>
<dd><p>Overall standard deviation of y-values for all individuals. If <code>family</code> =
     "Binary", <code>ysd</code> = 1.</p></dd>

     <dt>na.action</dt>
<dd><p>Remove missing values or impute?</p></dd>

     <dt>n</dt>
<dd><p>Total number of subjects.</p></dd>

     <dt>ni</dt>
<dd><p>Number of repeated measures for each subject.</p></dd>

     <dt>n.Q</dt>
<dd><p>Number of class labels for non-continuous response.</p></dd>

     <dt>Q_set</dt>
<dd><p>Class labels for the non-continuous response.</p></dd>

     <dt>y.unq</dt>
<dd><p>Unique y values for the non-continous response.</p></dd>

     <dt>y_reference</dt>
<dd><p>Reference value for family == "Nominal".</p></dd>

     <dt>tm.unq</dt>
<dd><p>Unique time points.</p></dd>

     <dt>gamma</dt>
<dd><p>List of length <em>M</em>, with each component
       containing the boosted tree fitted values.</p></dd>

     <dt>mu</dt>
<dd><p>List with each component containing the estimated mean
       values for an individual.  That is, each component contains the
       estimated time-profile for an individual.  When in-sample
       cross-validation is requested using <code class="command">cv.flag</code>=TRUE, the
       estimated mean is cross-validated and evaluated at the optimal
       number of iterations <code>Mopt</code>.
       If the family == "Nominal" or family == "Ordinal", <code>mu</code> will have a higher level
       of list to accommodate binary responses generated from nominal or ordinal response.</p></dd>

     <dt>Prob_class</dt>
<dd><p>For family == "Ordinal", this provides individual probabilty rather than
     cumulative probabilty.</p></dd>

     <dt>lambda</dt>
<dd><p>Smoothing parameter. Results provided in vector or matrix form, depending
     on whether family == c("Continuous","Binary") or family == c("Nominal", "Ordinal").</p></dd>

     <dt>phi</dt>
<dd><p>Variance parameter.Results provided in vector or matrix form, depending
     on whether family == c("Continuous","Binary") or family == c("Nominal", "Ordinal").</p></dd>

     <dt>rho</dt>
<dd><p>Correlation parameter.Results provided in vector or matrix form, depending
     on whether family == c("Continuous","Binary") or family == c("Nominal", "Ordinal").</p></dd>

     <dt>baselearner</dt>
<dd><p>List of length <em>M</em> containing the base learners.</p></dd>

     <dt>membership</dt>
<dd><p>List of length <em>M</em>, with each component
       containing the terminal node membership for a given boosting
       iteration.</p></dd>

     <dt>X.tm</dt>
<dd><p>Design matrix for all the unique time points.</p></dd>

     <dt>D</dt>
<dd><p>Design matrix for each subject.</p></dd>

     <dt>d</dt>
<dd><p>Degree of the piecewise B-spline polynomial.</p></dd>

     <dt>pen.ord</dt>
<dd><p>Penalization difference order.</p></dd>

     <dt>K</dt>
<dd><p>Number of terminal nodes.</p></dd>

     <dt>M</dt>
<dd><p>Number of boosting iterations.</p></dd>

     <dt>nu</dt>
<dd><p>Boosting regularization parameter.</p></dd>

     <dt>ntree</dt>
<dd><p>Number of trees.</p></dd>

     <dt>cv.flag</dt>
<dd><p>Whether in-sample CV is used or not?</p></dd>

     <dt>err.rate</dt>
<dd><p>In-sample standardized estimate of l1-error and RMSE.</p></dd>

     <dt>rmse</dt>
<dd><p>In-sample standardized RMSE at optimized <code>M</code>.</p></dd>

     <dt>Mopt</dt>
<dd><p>The optimized <code>M</code>.</p></dd>

     <dt>gamma.i.list</dt>
<dd><p>Estimate of gamma obtained from in-sample CV if <code>cv.flag</code> = TRUE,       else NULL</p></dd>

     <dt>forest.tol</dt>
<dd><p>Forest tolerance value (needed for prediction).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Hemant Ishwaran, Amol Pande and Udaya B. Kogalur</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Friedman J.H. (2001). Greedy function approximation: a gradient
  boosting machine, <em>Ann. of Statist.</em>, 5:1189-1232.</p>
<p>Friedman J.H. (2002). Stochastic gradient boosting.
  <em>Comp. Statist. Data Anal.</em>, 38(4):367–378.</p>
<p>Pande A., Li L., Rajeswaran J., Ehrlinger J., Kogalur U.B.,
  Blackstone E.H., Ishwaran H. (2017).  Boosted multivariate trees for
  longitudinal data, <em>Machine Learning</em>, 106(2): 277–305.</p>
<p>Pande A. (2017).  <em>Boosting for longitudinal data</em>.  Ph.D. Dissertation,
  Miller School of Medicine, University of Miami.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code class="command"><a href="marginalPlot.html">marginalPlot</a></code>
  <code class="command"><a href="partialPlot.html">partialPlot</a></code>,
  <code class="command"><a href="plot.boostmtree.html">plot.boostmtree</a></code>,
  <code class="command"><a href="predict.boostmtree.html">predict.boostmtree</a></code>,
  <code class="command"><a href="print.boostmtree.html">print.boostmtree</a></code>,
  <code class="command"><a href="simLong.html">simLong</a></code>,
  <code class="command"><a href="vimpPlot.html">vimpPlot</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">##------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## synthetic example (Response y is continuous)</span></span></span>
<span class="r-in"><span><span class="co">## 0.8 correlation, quadratic time with quadratic interaction</span></span></span>
<span class="r-in"><span><span class="co">##-------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">#simulate the data (use a small sample size for illustration)</span></span></span>
<span class="r-in"><span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="simLong.html">simLong</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, N <span class="op">=</span> <span class="fl">5</span>, rho <span class="op">=</span><span class="fl">.80</span>, model <span class="op">=</span> <span class="fl">2</span>,family <span class="op">=</span> <span class="st">"Continuous"</span><span class="op">)</span><span class="op">$</span><span class="va">dtaL</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#basic boosting call (M set to a small value for illustration)</span></span></span>
<span class="r-in"><span><span class="va">boost.grow</span> <span class="op">&lt;-</span> <span class="fu">boostmtree</span><span class="op">(</span><span class="va">dta</span><span class="op">$</span><span class="va">features</span>, <span class="va">dta</span><span class="op">$</span><span class="va">time</span>, <span class="va">dta</span><span class="op">$</span><span class="va">id</span>, <span class="va">dta</span><span class="op">$</span><span class="va">y</span>,family <span class="op">=</span> <span class="st">"Continuous"</span>,M <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#print results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">boost.grow</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model                       : mtree-Pspline learner </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fitting mode                : grow </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family                      : Continuous </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of K-terminal nodes  : 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> regularization parameter    : 0.05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample size                 : 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of variables         : 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of unique time points: 15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg. number of time points  : 7.96 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B-spline dimension          : 14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> penalization order          : 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> boosting iterations         : 20 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot.results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boost.grow</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Plot will be saved at:/tmp/RtmpnaXwOd</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## synthetic example (Response y is binary)</span></span></span>
<span class="r-in"><span><span class="co">## 0.8 correlation, quadratic time with quadratic interaction</span></span></span>
<span class="r-in"><span><span class="co">##-------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">#simulate the data (use a small sample size for illustration)</span></span></span>
<span class="r-in"><span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="simLong.html">simLong</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, N <span class="op">=</span> <span class="fl">5</span>, rho <span class="op">=</span><span class="fl">.80</span>, model <span class="op">=</span> <span class="fl">2</span>, family <span class="op">=</span> <span class="st">"Binary"</span><span class="op">)</span><span class="op">$</span><span class="va">dtaL</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#basic boosting call (M set to a small value for illustration)</span></span></span>
<span class="r-in"><span><span class="va">boost.grow</span> <span class="op">&lt;-</span> <span class="fu">boostmtree</span><span class="op">(</span><span class="va">dta</span><span class="op">$</span><span class="va">features</span>, <span class="va">dta</span><span class="op">$</span><span class="va">time</span>, <span class="va">dta</span><span class="op">$</span><span class="va">id</span>, <span class="va">dta</span><span class="op">$</span><span class="va">y</span>,family <span class="op">=</span> <span class="st">"Binary"</span>, M <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |====                                                                  |   5%  |                                                                              |=======                                                               |  10%  |                                                                              |==========                                                            |  15%  |                                                                              |==============                                                        |  20%  |                                                                              |==================                                                    |  25%  |                                                                              |=====================                                                 |  30%  |                                                                              |========================                                              |  35%  |                                                                              |============================                                          |  40%  |                                                                              |================================                                      |  45%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================                                |  55%  |                                                                              |==========================================                            |  60%  |                                                                              |==============================================                        |  65%  |                                                                              |=================================================                     |  70%  |                                                                              |====================================================                  |  75%  |                                                                              |========================================================              |  80%  |                                                                              |============================================================          |  85%  |                                                                              |===============================================================       |  90%  |                                                                              |==================================================================    |  95%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#print results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">boost.grow</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> model                       : mtree-Pspline learner </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fitting mode                : grow </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family                      : Binary </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of K-terminal nodes  : 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> regularization parameter    : 0.05 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample size                 : 50 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of variables         : 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of unique time points: 15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> avg. number of time points  : 8.48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B-spline dimension          : 14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> penalization order          : 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> boosting iterations         : 20 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#plot.results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boost.grow</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Plot will be saved at:/tmp/RtmpnaXwOd</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">##------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Same synthetic example as above with continuous response</span></span></span>
<span class="r-in"><span><span class="co">## but with in-sample cross-validation estimate for RMSE</span></span></span>
<span class="r-in"><span><span class="co">##-------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">dta</span> <span class="op">&lt;-</span> <span class="fu"><a href="simLong.html">simLong</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">50</span>, N <span class="op">=</span> <span class="fl">5</span>, rho <span class="op">=</span><span class="fl">.80</span>, model <span class="op">=</span> <span class="fl">2</span>,family <span class="op">=</span> <span class="st">"Continuous"</span><span class="op">)</span><span class="op">$</span><span class="va">dtaL</span></span></span>
<span class="r-in"><span><span class="va">boost.cv.grow</span> <span class="op">&lt;-</span> <span class="fu">boostmtree</span><span class="op">(</span><span class="va">dta</span><span class="op">$</span><span class="va">features</span>, <span class="va">dta</span><span class="op">$</span><span class="va">time</span>, <span class="va">dta</span><span class="op">$</span><span class="va">id</span>, <span class="va">dta</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>                 family <span class="op">=</span> <span class="st">"Continuous"</span>, M <span class="op">=</span> <span class="fl">300</span>, cv.flag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boost.cv.grow</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">boost.cv.grow</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## spirometry data (Response is continuous)</span></span></span>
<span class="r-in"><span><span class="co">##----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">spirometry</span>, package <span class="op">=</span> <span class="st">"boostmtree"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#boosting call: cubic B-splines with 15 knots</span></span></span>
<span class="r-in"><span><span class="va">spr.obj</span> <span class="op">&lt;-</span> <span class="fu">boostmtree</span><span class="op">(</span><span class="va">spirometry</span><span class="op">$</span><span class="va">features</span>, <span class="va">spirometry</span><span class="op">$</span><span class="va">time</span>, <span class="va">spirometry</span><span class="op">$</span><span class="va">id</span>, <span class="va">spirometry</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>                        family <span class="op">=</span> <span class="st">"Continuous"</span>,M <span class="op">=</span> <span class="fl">100</span>, nu <span class="op">=</span> <span class="fl">.025</span>, nknots <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">spr.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Atrial Fibrillation data (Response is binary)</span></span></span>
<span class="r-in"><span><span class="co">##----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">AF</span>, package <span class="op">=</span> <span class="st">"boostmtree"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#boosting call: cubic B-splines with 15 knots</span></span></span>
<span class="r-in"><span><span class="va">AF.obj</span> <span class="op">&lt;-</span> <span class="fu">boostmtree</span><span class="op">(</span><span class="va">AF</span><span class="op">$</span><span class="va">feature</span>, <span class="va">AF</span><span class="op">$</span><span class="va">time</span>, <span class="va">AF</span><span class="op">$</span><span class="va">id</span>, <span class="va">AF</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>                        family <span class="op">=</span> <span class="st">"Binary"</span>,M <span class="op">=</span> <span class="fl">100</span>, nu <span class="op">=</span> <span class="fl">.025</span>, nknots <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">AF.obj</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## sneaky way to use boostmtree for (univariate) regression: boston housing</span></span></span>
<span class="r-in"><span><span class="co">##----------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"mlbench"</span>, logical.return <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## assemble the data</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">BostonHousing</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">x</span> <span class="op">&lt;-</span> <span class="va">BostonHousing</span>; <span class="va">x</span><span class="op">$</span><span class="va">medv</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">BostonHousing</span><span class="op">$</span><span class="va">medv</span></span></span>
<span class="r-in"><span>  <span class="va">trn</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">2</span> <span class="op">/</span> <span class="fl">3</span><span class="op">)</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## run boosting in univariate mode</span></span></span>
<span class="r-in"><span>  <span class="va">o</span> <span class="op">&lt;-</span> <span class="fu">boostmtree</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">trn</span>,<span class="op">]</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">trn</span><span class="op">]</span>,family <span class="op">=</span> <span class="st">"Continuous"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">o.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">o</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="op">-</span><span class="va">trn</span>, <span class="op">]</span>, y <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="op">-</span><span class="va">trn</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">o</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o.p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co">## run boosting in univariate mode to obtain RMSE and vimp</span></span></span>
<span class="r-in"><span>  <span class="va">o.cv</span> <span class="op">&lt;-</span> <span class="fu">boostmtree</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, M <span class="op">=</span> <span class="fl">100</span>,family <span class="op">=</span> <span class="st">"Continuous"</span>,cv.flag <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">o.cv</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">o.cv</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Udaya B. Kogalur.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

